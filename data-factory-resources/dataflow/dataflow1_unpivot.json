{
	"name": "dataflow1_unpivot",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "AzureSqlTable2",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureSqlTable3",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "unpivot1"
				},
				{
					"name": "RemoveColumns1",
					"description": "Autogenerated by data preview actions"
				},
				{
					"name": "RemoveColumns2",
					"description": "Autogenerated by data preview actions"
				},
				{
					"name": "RemoveColumns3",
					"description": "Autogenerated by data preview actions"
				}
			],
			"scriptLines": [
				"source(output(",
				"          country as string,",
				"          data_provider as string,",
				"          channel as string,",
				"          sku as string,",
				"          loc_sub_brand as string,",
				"          loc_brand as string,",
				"          loc_sub_category_3 as string,",
				"          loc_category as string,",
				"          pack_size as string,",
				"          unit_of_measure as string,",
				"          pack_form as string,",
				"          pack_strength as string,",
				"          active_ingredient as string,",
				"          manufacturer as string,",
				"          atc_code as string,",
				"          otc_code as string,",
				"          promo_non_promo as string,",
				"          promo_type as string,",
				"          currency as string,",
				"          measure as string,",
				"          end_data_of_latest_data_period as string,",
				"          month_1 as string,",
				"          month_2 as string,",
				"          month_3 as string,",
				"          month_4 as string,",
				"          month_5 as string,",
				"          month_6 as string,",
				"          month_7 as string,",
				"          month_8 as string,",
				"          month_9 as string,",
				"          month_10 as string,",
				"          month_11 as string,",
				"          month_12 as string,",
				"          month_13 as string,",
				"          month_14 as string,",
				"          month_15 as string,",
				"          month_16 as string,",
				"          month_17 as string,",
				"          month_18 as string,",
				"          month_19 as string,",
				"          month_20 as string,",
				"          month_21 as string,",
				"          month_22 as string,",
				"          month_23 as string,",
				"          month_24 as string,",
				"          month_25 as string,",
				"          month_26 as string,",
				"          month_27 as string,",
				"          month_28 as string,",
				"          month_29 as string,",
				"          month_30 as string,",
				"          month_31 as string,",
				"          month_32 as string,",
				"          month_33 as string,",
				"          month_34 as string,",
				"          month_35 as string,",
				"          month_36 as string,",
				"          month_37 as string,",
				"          month_38 as string,",
				"          month_39 as string,",
				"          month_40 as string,",
				"          month_41 as string,",
				"          month_42 as string,",
				"          month_43 as string,",
				"          month_44 as string,",
				"          month_45 as string,",
				"          month_46 as string,",
				"          month_47 as string,",
				"          month_48 as string,",
				"          month_49 as string,",
				"          month_50 as string,",
				"          month_51 as string,",
				"          month_52 as string,",
				"          month_53 as string,",
				"          month_54 as string,",
				"          month_55 as string,",
				"          month_56 as string,",
				"          month_57 as string,",
				"          month_58 as string,",
				"          month_59 as string,",
				"          month_60 as string,",
				"          filename as string,",
				"          load_date as timestamp,",
				"          load_id as decimal(18,0)",
				"     ),",
				"     allowSchemaDrift: false,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     format: 'table') ~> source1",
				"RemoveColumns3 unpivot(output(",
				"          Months as float,",
				"          Values as string",
				"     ),",
				"     ungroupBy(country,",
				"          data_provider,",
				"          channel,",
				"          sku,",
				"          loc_sub_brand,",
				"          loc_brand,",
				"          loc_sub_category_3,",
				"          loc_category,",
				"          pack_size,",
				"          unit_of_measure,",
				"          pack_form,",
				"          pack_strength,",
				"          active_ingredient,",
				"          manufacturer,",
				"          atc_code,",
				"          otc_code,",
				"          promo_non_promo,",
				"          promo_type,",
				"          currency,",
				"          measure,",
				"          end_data_of_latest_data_period),",
				"     lateral: true,",
				"     ignoreNullPivots: false) ~> unpivot1",
				"source1 select(mapColumn(",
				"          country,",
				"          data_provider,",
				"          channel,",
				"          sku,",
				"          loc_sub_brand,",
				"          loc_brand,",
				"          loc_sub_category_3,",
				"          loc_category,",
				"          pack_size,",
				"          unit_of_measure,",
				"          pack_form,",
				"          pack_strength,",
				"          active_ingredient,",
				"          manufacturer,",
				"          atc_code,",
				"          otc_code,",
				"          promo_non_promo,",
				"          promo_type,",
				"          currency,",
				"          measure,",
				"          end_data_of_latest_data_period,",
				"          month_1,",
				"          month_2,",
				"          month_3,",
				"          month_4,",
				"          month_5,",
				"          month_6,",
				"          month_7,",
				"          month_8,",
				"          month_9,",
				"          month_10,",
				"          month_11,",
				"          month_12,",
				"          month_13,",
				"          month_14,",
				"          month_15,",
				"          month_16,",
				"          month_17,",
				"          month_18,",
				"          month_19,",
				"          month_20,",
				"          month_21,",
				"          month_22,",
				"          month_23,",
				"          month_24,",
				"          month_25,",
				"          month_26,",
				"          month_27,",
				"          month_28,",
				"          month_29,",
				"          month_30,",
				"          month_31,",
				"          month_32,",
				"          month_33,",
				"          month_34,",
				"          month_35,",
				"          month_36,",
				"          month_37,",
				"          month_38,",
				"          month_39,",
				"          month_40,",
				"          month_41,",
				"          month_42,",
				"          month_43,",
				"          month_44,",
				"          month_45,",
				"          month_46,",
				"          month_47,",
				"          month_48,",
				"          month_49,",
				"          month_50,",
				"          month_51,",
				"          month_52,",
				"          month_53,",
				"          month_54,",
				"          month_55,",
				"          month_56,",
				"          month_57,",
				"          month_58,",
				"          month_59,",
				"          month_60,",
				"          filename,",
				"          load_date",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> RemoveColumns1",
				"RemoveColumns1 select(mapColumn(",
				"          country,",
				"          data_provider,",
				"          channel,",
				"          sku,",
				"          loc_sub_brand,",
				"          loc_brand,",
				"          loc_sub_category_3,",
				"          loc_category,",
				"          pack_size,",
				"          unit_of_measure,",
				"          pack_form,",
				"          pack_strength,",
				"          active_ingredient,",
				"          manufacturer,",
				"          atc_code,",
				"          otc_code,",
				"          promo_non_promo,",
				"          promo_type,",
				"          currency,",
				"          measure,",
				"          end_data_of_latest_data_period,",
				"          month_1,",
				"          month_2,",
				"          month_3,",
				"          month_4,",
				"          month_5,",
				"          month_6,",
				"          month_7,",
				"          month_8,",
				"          month_9,",
				"          month_10,",
				"          month_11,",
				"          month_12,",
				"          month_13,",
				"          month_14,",
				"          month_15,",
				"          month_16,",
				"          month_17,",
				"          month_18,",
				"          month_19,",
				"          month_20,",
				"          month_21,",
				"          month_22,",
				"          month_23,",
				"          month_24,",
				"          month_25,",
				"          month_26,",
				"          month_27,",
				"          month_28,",
				"          month_29,",
				"          month_30,",
				"          month_31,",
				"          month_32,",
				"          month_33,",
				"          month_34,",
				"          month_35,",
				"          month_36,",
				"          month_37,",
				"          month_38,",
				"          month_39,",
				"          month_40,",
				"          month_41,",
				"          month_42,",
				"          month_43,",
				"          month_44,",
				"          month_45,",
				"          month_46,",
				"          month_47,",
				"          month_48,",
				"          month_49,",
				"          month_50,",
				"          month_51,",
				"          month_52,",
				"          month_53,",
				"          month_54,",
				"          month_55,",
				"          month_56,",
				"          month_57,",
				"          month_58,",
				"          month_59,",
				"          month_60,",
				"          filename",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> RemoveColumns2",
				"RemoveColumns2 select(mapColumn(",
				"          country,",
				"          data_provider,",
				"          channel,",
				"          sku,",
				"          loc_sub_brand,",
				"          loc_brand,",
				"          loc_sub_category_3,",
				"          loc_category,",
				"          pack_size,",
				"          unit_of_measure,",
				"          pack_form,",
				"          pack_strength,",
				"          active_ingredient,",
				"          manufacturer,",
				"          atc_code,",
				"          otc_code,",
				"          promo_non_promo,",
				"          promo_type,",
				"          currency,",
				"          measure,",
				"          end_data_of_latest_data_period,",
				"          month_1,",
				"          month_2,",
				"          month_3,",
				"          month_4,",
				"          month_5,",
				"          month_6,",
				"          month_7,",
				"          month_8,",
				"          month_9,",
				"          month_10,",
				"          month_11,",
				"          month_12,",
				"          month_13,",
				"          month_14,",
				"          month_15,",
				"          month_16,",
				"          month_17,",
				"          month_18,",
				"          month_19,",
				"          month_20,",
				"          month_21,",
				"          month_22,",
				"          month_23,",
				"          month_24,",
				"          month_25,",
				"          month_26,",
				"          month_27,",
				"          month_28,",
				"          month_29,",
				"          month_30,",
				"          month_31,",
				"          month_32,",
				"          month_33,",
				"          month_34,",
				"          month_35,",
				"          month_36,",
				"          month_37,",
				"          month_38,",
				"          month_39,",
				"          month_40,",
				"          month_41,",
				"          month_42,",
				"          month_43,",
				"          month_44,",
				"          month_45,",
				"          month_46,",
				"          month_47,",
				"          month_48,",
				"          month_49,",
				"          month_50,",
				"          month_51,",
				"          month_52,",
				"          month_53,",
				"          month_54,",
				"          month_55,",
				"          month_56,",
				"          month_57,",
				"          month_58,",
				"          month_59,",
				"          month_60",
				"     ),",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true) ~> RemoveColumns3",
				"unpivot1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     deletable:false,",
				"     insertable:true,",
				"     updateable:false,",
				"     upsertable:false,",
				"     recreate:true,",
				"     format: 'table',",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     errorHandlingOption: 'stopOnFirstError') ~> sink1"
			]
		}
	}
}